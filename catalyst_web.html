<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Catalyst Web of Science</title>
    <style>
        /* --- Basic Setup & Fonts --- */
        @import url('https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@300;400&family=Inter:wght@400;600;700&display=swap');

        :root {
            --bg-color: #02040a;
            --text-color: #e6f1ff;
            --accent-color: #00f2ea;
            --glow-color: rgba(0, 242, 234, 0.75);
            --card-bg: rgba(13, 17, 23, 0.85);
            --border-color: rgba(0, 242, 234, 0.3);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow: hidden;
            height: 100vh;
            width: 100vw;
        }

        /* --- Main Container & Canvas Layers --- */
        #catalyst-map-container {
            position: relative;
            width: 100%;
            height: 100%;
        }
        
        .animation-canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }

        #map-nodes-wrapper {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 5;
        }
        
        /* --- Article Nodes --- */
        .article-node {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #fff;
            border-radius: 50%;
            cursor: pointer;
            z-index: 10;
            transition: transform 0.3s ease, box-shadow 0.3s ease, opacity 0.5s ease;
            box-shadow: 0 0 8px #fff, 0 0 12px var(--glow-color);
            animation: pulse-star 4s infinite ease-in-out;
            transform: scale(0);
            opacity: 0;
        }
        
        .article-node.visible {
            transform: scale(1);
            opacity: 1;
        }

        .article-node:hover {
            transform: scale(2.8) !important;
            animation-play-state: paused;
        }
        
        /* --- Filtering Logic --- */
        #catalyst-map-container.filtered .article-node {
            opacity: 0.1;
            transform: scale(0.5) !important;
            animation: none;
        }

        #catalyst-map-container.filtered .article-node.active {
            opacity: 1;
            transform: scale(1.5) !important;
            animation: pulse-star 2s infinite ease-in-out;
        }
        
        /* --- Animations --- */
        @keyframes pulse-star {
            0%, 100% { transform: scale(1); box-shadow: 0 0 8px #fff, 0 0 12px var(--glow-color); }
            50% { transform: scale(1.2); box-shadow: 0 0 16px #fff, 0 0 24px var(--glow-color); }
        }

        /* --- Tooltip on Hover --- */
        .node-tooltip {
            position: absolute;
            bottom: 180%; 
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--card-bg);
            color: var(--text-color);
            padding: 8px 14px;
            border-radius: 6px;
            font-size: 13px;
            font-family: 'Roboto Mono', monospace;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            pointer-events: none;
            z-index: 100;
            border: 1px solid var(--border-color);
        }

        .article-node:hover .node-tooltip {
            opacity: 1;
            visibility: visible;
        }
        
        /* --- Filter Menu UI --- */
        #filter-menu {
            position: absolute;
            top: 20px;
            left: 20px;
            background-color: var(--card-bg);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            z-index: 50;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
            opacity: 0;
            transform: translateX(-30px);
            animation: fadeIn 0.5s ease-out 0.5s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; transform: translateX(0); }
        }

        #filter-menu h2 {
            margin: 0 0 15px 0;
            font-size: 16px;
            font-weight: 400;
            font-family: 'Roboto Mono', monospace;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 10px;
            color: var(--accent-color);
        }

        #filter-menu button {
            display: block;
            width: 100%;
            padding: 8px 12px;
            margin-bottom: 8px;
            border: 1px solid transparent;
            background-color: transparent;
            color: var(--text-color);
            text-align: left;
            font-family: 'Roboto Mono', monospace;
            font-size: 14px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
        }

        #filter-menu button:hover {
            background-color: var(--border-color);
            color: #fff;
        }

        #filter-menu button.active {
            background-color: var(--accent-color);
            color: var(--bg-color);
            font-weight: 700;
        }
        
        /* --- Info Card --- */
        #info-card {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            width: 90%;
            max-width: 480px;
            background-color: var(--card-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-color);
            border-radius: 16px;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, transform 0.3s ease;
            box-shadow: 0 10px 40px 0 rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
        }

        #info-card.visible {
            opacity: 1;
            visibility: visible;
            transform: translate(-50%, -50%) scale(1);
        }

        #card-image-container {
            width: 100%;
            height: 200px;
            border-radius: 15px 15px 0 0;
            overflow: hidden;
        }

        #card-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-bottom: 1px solid var(--border-color);
        }

        #card-content {
            padding: 25px;
        }

        #card-content h3 {
            font-size: 22px;
            color: var(--accent-color);
            margin: 0 0 8px 0;
        }

        #card-content p.author {
            font-size: 14px;
            font-style: italic;
            color: #8b949e;
            margin-bottom: 16px;
        }

        #card-content p.summary {
            font-size: 15px;
            line-height: 1.6;
            margin-bottom: 20px;
        }

        #card-content a.read-more {
            display: inline-block;
            background-color: var(--accent-color);
            color: var(--bg-color);
            padding: 12px 18px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 700;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        #card-content a.read-more:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--glow-color);
        }

        #close-card-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 50%;
            width: 32px;
            height: 32px;
            color: var(--text-color);
            font-size: 20px;
            cursor: pointer;
            line-height: 30px;
            text-align: center;
            transition: background-color 0.2s;
            z-index: 110;
        }
        #close-card-btn:hover {
            background-color: rgba(255,255,255,0.2);
        }
        
        @media (max-width: 768px) {
            #filter-menu {
                top: auto; bottom: 10px; left: 10px; right: 10px;
                width: auto; display: flex; flex-wrap: wrap; justify-content: center; padding: 5px;
            }
            #filter-menu h2 { display: none; }
            #filter-menu button { font-size: 12px; padding: 6px 10px; margin: 4px; }
            .article-node { width: 10px; height: 10px; }
            #info-card { max-width: 95%; }
            #card-content h3 { font-size: 18px; }
            #card-content p.summary { font-size: 14px; }
        }
    </style>
</head>
<body>

    <div id="catalyst-map-container">
        <canvas id="bg-canvas" class="animation-canvas"></canvas>
        <canvas id="fg-canvas" class="animation-canvas"></canvas>
        <div id="map-nodes-wrapper"></div>

        <div id="filter-menu">
            <h2>// EXPLORE BY FIELD</h2>
            <button id="filter-all" class="active">./show_all</button>
        </div>

        <div id="info-card">
            <div id="card-image-container">
                <img id="card-image" src="" alt="Article Cover Art">
            </div>
            <div id="card-content">
                <button id="close-card-btn">&times;</button>
                <h3 id="card-title"></h3>
                <p class="author" id="card-author"></p>
                <p class="summary" id="card-summary"></p>
                <a href="#" id="card-link" class="read-more" target="_blank" rel="noopener noreferrer">Read Full Article</a>
            </div>
        </div>
    </div>

    <script>
        const articleData = [
            { "id": "art0", "title": "The Road From Academia to Forensic Applications of Chemistry", "author": "Naama Ben-Dor", "summary": "While many scientific pursuits involve structured pre-professional programs...", "link": "https://www.catalyst-magazine.com/post/the-road-from-academia-to-forensic-applications-of-chemistry", "category": "Science & Policy", "image": "https://static.wixstatic.com/media/11b1c4_9737d25c5ad74ba7829973eb7513f61a~mv2.jpeg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art1", "title": "How One Engineer is Changing Sustainable Fuels", "author": "Aidan Schurr", "summary": "Tyler Wyka bridges engineering, sustainability, and global collaboration...", "link": "https://www.catalyst-magazine.com/post/how-one-engineer-is-changing-sustainable-fuels", "category": "Tech & Engineering", "image": "https://static.wixstatic.com/media/11b1c4_4491d15e55c94d058d2a63eedf3cfc42~mv2.png/v1/fill/w_780,h_452,al_c,q_85,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.png" },
            { "id": "art2", "title": "From Music to Nuclear Policy: Dr. Cahill’s Journey in Science and Policy", "author": "Lori Preci and Yair Ben-Dor", "summary": "From music to materials science, Professor Christopher Cahill’s journey shows how unexpected turns spark curiosity...", "link": "https://www.catalyst-magazine.com/post/from-music-to-nuclear-policy-professor-christopher-cahill-s-unexpected-journey-in-science-and-polic", "category": "Science & Policy", "image": "https://static.wixstatic.com/media/11b1c4_0c15687348b442c5ab1d0a2295571751~mv2.jpeg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art3", "title": "Dr. Song Gao’s Chemistry‑Policy Crusade Against Hidden Pollutants", "author": "Naama Ben-Dor", "summary": "Dr. Song Gao bridges science and policy to tackle climate change, ozone depletion, and environmental sustainability.", "link": "https://www.catalyst-magazine.com/post/pollution-to-solution-dr-song-gao-on-science-policy-and-environmental-sustainability", "category": "Environmental Science", "image": "https://static.wixstatic.com/media/11b1c4_0384c4b9d49545a3b2e708073485f11b~mv2.jpg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" },
            { "id": "art4", "title": "Designing a Sustainable Future with Sun, Wind, and Water", "author": "Ginger Taurek", "summary": "For innovator Scott Sklar, renewable energy is about more than climate—it’s about human survival...", "link": "https://www.catalyst-magazine.com/post/designing-a-sustainable-future-with-sun-wind-and-water", "category": "Environmental Science", "image": "https://static.wixstatic.com/media/11b1c4_0fe12e2d642740d6b58bbda1df751199~mv2.jpeg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art5", "title": "Dr. Brent Harris’ Brain Bank Revolution", "author": "Aidan Schurr", "summary": "Working in DC lets Dr. Brent Harris drive medical changes. His neuropathology, ALS research, and advocacy...", "link": "https://www.catalyst-magazine.com/post/from-brain-to-bench-to-bedside-and-beyond-how-a-dc-neuroscientist-is-changing-brain-disease-researc", "category": "Health & Medicine", "image": "https://static.wixstatic.com/media/11b1c4_0790d57e5eef4d119d3c9497017df5ca~mv2.jpeg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art6", "title": "How The World of Genetics Shapes Evolution", "author": "Alex Carter", "summary": "Evolution shapes life, but its genetic origins remain a mystery. How do tiny DNA changes create stunning adaptations?", "link": "https://www.catalyst-magazine.com/post/how-the-world-of-genetics-shapes-evolution", "category": "Health & Medicine", "image": "https://static.wixstatic.com/media/11b1c4_9e5fcb3b2c194aba87fb93241ade3b8b~mv2.jpeg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art7", "title": "Serendipity and Science: The Journey of Dr. John Hawdon", "author": "Lori Preci", "summary": "Dr. Hawdon’s Winding Path to Parasitology...", "link": "https://www.catalyst-magazine.com/post/serendipity-and-science-the-journey-of-dr-john-hawdon", "category": "Health & Medicine", "image": "https://static.wixstatic.com/media/44031f_75620e6213e04a56b298580689208fce~mv2.jpeg/v1/fill/w_709,h_411,al_c,q_80,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art8", "title": "Elucidating the Brain’s Language Circuitry with Dr. Michael Ullman", "author": "Yair Ben-Dor", "summary": "Georgetown neuroscientist Dr. Michael T. Ullman's Declarative/Procedural (DP) model posits language relies on two core brain memory systems.", "link": "https://www.catalyst-magazine.com/post/elucidating-the-brain-s-language-circuitry-with-dr-michael-ullman", "category": "Neuroscience & Cognition", "image": "https://static.wixstatic.com/media/11b1c4_4d74a6206a0f43c9a38125c8bc03e28e~mv2.jpg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" },
            { "id": "art9", "title": "How Cutting-Edge Research in Washington, D.C. is Reshaping Science and Medicine", "author": "Yair Ben-Dor", "summary": "Researchers in Washington D.C. are revolutionizing AI, MS treatments, and cancer therapies...", "link": "https://www.catalyst-magazine.com/post/how-cutting-edge-research-in-washington-d-c-is-reshaping-science-and-medicine", "category": "Health & Medicine", "image": "https://static.wixstatic.com/media/11b1c4_aa825fc11e6740d0a40a12f2ea19bf56~mv2.jpeg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art10", "title": "From Battling a Rare Bioweapon Pathogen to Pioneering Global Health Security", "author": "Aidan Schurr", "summary": "Rebecca Katz’s plan to volunteer in India was unraveled by a severe illness...", "link": "https://www.catalyst-magazine.com/post/reframing-health-as-a-national-security-issue", "category": "Science & Policy", "image": "https://static.wixstatic.com/media/11b1c4_47e7a044e37c4cceb9dd09977d590c30~mv2.jpg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" },
            { "id": "art11", "title": "Sitting Down with the Editor‑in‑Chief of Science Magazine", "author": "Alex Carter and Aidan Schurr", "summary": "In an era of growing skepticism and polarized discourse, clear science communication is more vital than ever.", "link": "https://www.catalyst-magazine.com/post/sitting-down-with-the-editor-in-chief-of-science-magazine-to-talk-about-the-future-of-scientific-co", "category": "Science & Policy", "image": "https://static.wixstatic.com/media/11b1c4_548f96bc13fa4021b9b0c26e3f625fcc~mv2.jpg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" },
            { "id": "art12", "title": "How Coastal Trees Adapt Amid Rising Seas", "author": "Aidan Brown", "summary": "With rising seas and worsening droughts, coastal forests face an uncertain future...", "link": "https://www.catalyst-magazine.com/post/how-coastal-trees-adapt-amid-rising-seas", "category": "Environmental Science", "image": "https://static.wixstatic.com/media/11062b_cd21ba7620aa42098bfc60aa98d6ff52~mv2.jpg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" },
            { "id": "art13", "title": "A Universe of Plasma: How One Scientist Connects His World From Satellites to Cells", "author": "Aidan Schurr", "summary": "Every scientist begins their journey with a general sense of direction...", "link": "https://www.catalyst-magazine.com/post/a-universe-of-plasma-how-one-scientist-connects-his-world-from-satellites-to-cells", "category": "Tech & Engineering", "image": "https://static.wixstatic.com/media/11b1c4_5623b55dcf734591a3d3feca82b1d76d~mv2.jpeg/v1/fill/w_780,h_452,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art14", "title": "The Electric Romance of Electricity and Magnetism", "author": "Yair Ben-Dor", "summary": "They say opposites attract, but when it comes to electric and magnetic fields, it’s more like two halves of an amazing whole...", "link": "https://www.catalyst-magazine.com/post/the-electric-romance-of-electricity-and-magnetism", "category": "Tech & Engineering", "image": "https://static.wixstatic.com/media/11062b_518e16b449c74e648b16526713fc627b~mv2.jpg/v1/fill/w_780,h_436,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" },
            { "id": "art15", "title": "Genetics Behind the Beauty: Insect Coloration and Evolution", "author": "Alex Carter", "summary": "How do insects get their colors? Gene regulation drives patterns, mimicry, and behavior...", "link": "https://www.catalyst-magazine.com/post/the-significance-of-genetics-in-insect-coloration-and-evolution", "category": "Health & Medicine", "image": "https://static.wixstatic.com/media/11b1c4_c36a2040d8584806b5c9e025f1736bc8~mv2.jpeg/v1/fill/w_780,h_436,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art16", "title": "Cheers to Microglia: Unsung Heroes of the Nervous System", "author": "Naama Ben-Dor", "summary": "Amid the nervous system’s intricate cast, microglia are the tireless unsung heroes...", "link": "https://www.catalyst-magazine.com/post/an-ode-to-microglia", "category": "Neuroscience & Cognition", "image": "https://static.wixstatic.com/media/11b1c4_1dc1366839bf48af8acaeca849c198bd~mv2.jpeg/v1/fill/w_780,h_436,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art17", "title": "Science’s Silly Lexicon: Wacky Words to Brighten Your Day", "author": "Naama Ben-Dor", "summary": "Science is serious, but its words don’t have to be! From habenula perforata to Tribbles...", "link": "https://www.catalyst-magazine.com/post/science-s-silly-lexicon-wacky-words-to-brighten-your-day-and-casually-drop-into-conversation", "category": "Science & Policy", "image": "https://static.wixstatic.com/media/11b1c4_cbb1af6fc4d14f7e9234a01bd9d802ac~mv2.jpeg/v1/fill/w_780,h_436,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art18", "title": "Understanding Science to Learn Science: Dopamine and...", "author": "Naama Ben-Dor", "summary": "STEM studies demand a uniquely high level of rigorous dedication and studiousness...", "link": "https://www.catalyst-magazine.com/post/understanding-science-to-learn-science-dopamine-and-why-you-should-care", "category": "Neuroscience & Cognition", "image": "https://static.wixstatic.com/media/11b1c4_c93db0b3162140a9a44f871d3ade2c83~mv2.jpg/v1/fill/w_780,h_436,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" },
            { "id": "art19", "title": "Paradoxes in Science: Where Models Go to Break", "author": "Lori Preci", "summary": "If you’re curious about anything, you’ve already stepped into paradox...", "link": "https://www.catalyst-magazine.com/post/paradoxes-in-science-where-models-go-to-break", "category": "Science & Policy", "image": "https://static.wixstatic.com/media/11b1c4_372453015cd14622890ac0740c9090a6~mv2.jpg/v1/fill/w_780,h_436,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" },
            { "id": "art20", "title": "Transition Metals and How They Color Our World", "author": "Lori Preci", "summary": "Transition metals are responsible for some of the most dazzling colors we encounter every day...", "link": "https://www.catalyst-magazine.com/post/transition-metals-the-capacity-of-the-d-block-to-color-our-world", "category": "Tech & Engineering", "image": "https://static.wixstatic.com/media/11b1c4_26ae100a7205477c96367e1b126ffee5~mv2.jpeg/v1/fill/w_780,h_436,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpeg" },
            { "id": "art21", "title": "Everything Sings: The Science of Systems ", "author": "Aidan Schurr", "summary": "With the ever growing amount of information in the world, our understanding of the most complex systems can be enhanced...", "link": "https://www.catalyst-magazine.com/post/everything-sings-the-science-of-systems", "category": "Science & Policy", "image": "https://static.wixstatic.com/media/11b1c4_b73ead9ded89474ea6a93856a97b81b4~mv2.jpg/v1/fill/w_780,h_436,al_c,q_80,usm_0.66_1.00_0.01,enc_avif,quality_auto/shutterstock_1898354080.jpg" }
        ];

        // --- DOM Elements & Canvas Setup ---
        const mapContainer = document.getElementById('catalyst-map-container');
        const nodesWrapper = document.getElementById('map-nodes-wrapper');
        const filterMenu = document.getElementById('filter-menu');
        const infoCard = document.getElementById('info-card');
        const closeCardBtn = document.getElementById('close-card-btn');
        const bgCanvas = document.getElementById('bg-canvas');
        const fgCanvas = document.getElementById('fg-canvas');
        const bgCtx = bgCanvas.getContext('2d');
        const fgCtx = fgCanvas.getContext('2d');
        
        let regions = {};
        let activeConnections = [];
        let catalystHub = {};

        // --- Canvas & Animation Functions ---
        function resizeCanvas() {
            bgCanvas.width = window.innerWidth;
            bgCanvas.height = window.innerHeight;
            fgCanvas.width = window.innerWidth;
            fgCanvas.height = window.innerHeight;
            catalystHub = { x: fgCanvas.width / 2, y: fgCanvas.height / 2, radius: 20 };
            setupRegions();
        }

        function setupRegions() {
            const categories = [...new Set(articleData.map(article => article.category))];
            const numRegions = categories.length;
            const angleIncrement = (2 * Math.PI) / numRegions;
            const mainRadius = Math.min(bgCanvas.width, bgCanvas.height) * 0.3;
            
            const colors = {
                "Neuroscience & Cognition": "rgba(138, 43, 226, 0.3)", // BlueViolet
                "Health & Medicine": "rgba(0, 191, 255, 0.3)", // DeepSkyBlue
                "Environmental Science": "rgba(34, 139, 34, 0.3)", // ForestGreen
                "Tech & Engineering": "rgba(255, 69, 0, 0.3)", // OrangeRed
                "Science & Policy": "rgba(255, 215, 0, 0.3)" // Gold
            };

            regions = {}; // Clear and rebuild
            categories.sort().forEach((category, i) => {
                const angle = i * angleIncrement;
                regions[category] = {
                    x: bgCanvas.width / 2 + Math.cos(angle) * mainRadius,
                    y: bgCanvas.height / 2 + Math.sin(angle) * mainRadius,
                    radius: Math.min(bgCanvas.width, bgCanvas.height) * 0.15,
                    color: colors[category] || "rgba(128, 128, 128, 0.3)",
                    label: category
                };
            });
        }

        function animate() {
            // --- Animate Foreground (Connections & Hub) ---
            fgCtx.clearRect(0, 0, fgCanvas.width, fgCanvas.height);
            
            // Draw Catalyst Hub
            const hubGradient = fgCtx.createRadialGradient(catalystHub.x, catalystHub.y, 0, catalystHub.x, catalystHub.y, catalystHub.radius);
            hubGradient.addColorStop(0, 'rgba(0, 242, 234, 1)');
            hubGradient.addColorStop(1, 'rgba(0, 242, 234, 0)');
            fgCtx.fillStyle = hubGradient;
            fgCtx.beginPath();
            fgCtx.arc(catalystHub.x, catalystHub.y, catalystHub.radius * (1 + Math.sin(Date.now() * 0.002) * 0.2), 0, Math.PI * 2);
            fgCtx.fill();

            // Draw active connections
            fgCtx.strokeStyle = 'rgba(0, 242, 234, 0.6)';
            fgCtx.lineWidth = 1.5;
            fgCtx.shadowColor = 'rgba(0, 242, 234, 1)';
            fgCtx.shadowBlur = 10;
            activeConnections.forEach(conn => {
                ctx.beginPath();
                ctx.moveTo(conn.x1, conn.y1);
                ctx.lineTo(conn.x2, conn.y2);
                ctx.stroke();
            });
            fgCtx.shadowBlur = 0;

            requestAnimationFrame(animate);
        }
        
        function drawBackground() {
            bgCtx.clearRect(0, 0, bgCanvas.width, bgCanvas.height);
            let activeCategory = document.querySelector('#filter-menu button.active')?.dataset.category;

            Object.values(regions).forEach(region => {
                const isActive = region.label === activeCategory || !mapContainer.classList.contains('filtered');
                const gradient = bgCtx.createRadialGradient(region.x, region.y, 0, region.x, region.y, region.radius);
                const baseColor = region.color.replace(/, 0.3\)/, '');
                
                gradient.addColorStop(0, `${baseColor}, ${isActive ? 0.4 : 0.1})`);
                gradient.addColorStop(1, `${baseColor}, 0)`);

                bgCtx.fillStyle = gradient;
                bgCtx.beginPath();
                bgCtx.arc(region.x, region.y, region.radius, 0, Math.PI * 2);
                bgCtx.fill();
                
                bgCtx.fillStyle = `rgba(230, 241, 255, ${isActive ? 0.8 : 0.4})`;
                bgCtx.font = "14px 'Roboto Mono', monospace";
                bgCtx.textAlign = 'center';
                bgCtx.fillText(region.label, region.x, region.y);
            });
        }

        // --- Main Application Logic ---
        function initializeMap() {
            const categories = [...new Set(articleData.map(article => article.category))];
            const filterAllBtn = document.getElementById('filter-all');

            categories.sort().forEach(category => {
                const btn = document.createElement('button');
                btn.id = `filter-${category.replace(/[^a-zA-Z0-9]/g, '')}`;
                btn.textContent = `./${category.toLowerCase().replace(/[ &]/g, '_')}`;
                btn.dataset.category = category;
                btn.addEventListener('click', () => handleFilterClick(category, btn));
                filterMenu.appendChild(btn);
            });

            articleData.forEach((article, index) => {
                const node = document.createElement('div');
                node.className = 'article-node';
                
                const region = regions[article.category];
                const angle = Math.random() * 2 * Math.PI;
                const radius = Math.random() * (region.radius * 0.8);
                const x = region.x + Math.cos(angle) * radius;
                const y = region.y + Math.sin(angle) * radius;
                
                node.style.left = `${x}px`;
                node.style.top = `${y}px`;
                node.style.transformOrigin = 'center';

                node.dataset.category = article.category;
                node.style.animationDelay = `${index * 0.05}s`;

                const tooltip = document.createElement('div');
                tooltip.className = 'node-tooltip';
                tooltip.textContent = article.title;
                node.appendChild(tooltip);

                node.addEventListener('click', () => showInfoCard(article));
                nodesWrapper.appendChild(node);
                
                setTimeout(() => node.classList.add('visible'), 100 + index * 50);
            });
            
            filterAllBtn.addEventListener('click', () => handleFilterClick('all', filterAllBtn));
        }

        function handleFilterClick(category, clickedButton) {
            document.querySelectorAll('#filter-menu button').forEach(btn => btn.classList.remove('active'));
            clickedButton.classList.add('active');
            
            activeConnections = [];

            if (category === 'all') {
                mapContainer.classList.remove('filtered');
                document.querySelectorAll('.article-node').forEach(node => node.classList.remove('active'));
            } else {
                mapContainer.classList.add('filtered');
                const centerX = fgCanvas.width / 2;
                const centerY = fgCanvas.height / 2;

                document.querySelectorAll('.article-node').forEach(node => {
                    const isActive = node.dataset.category === category;
                    node.classList.toggle('active', isActive);
                    if (isActive) {
                        const rect = node.getBoundingClientRect();
                        activeConnections.push({
                            x1: centerX,
                            y1: centerY,
                            x2: rect.left + rect.width / 2,
                            y2: rect.top + rect.height / 2
                        });
                    }
                });
            }
            drawBackground(); // Redraw background to update highlights
        }

        function showInfoCard(article) {
            document.getElementById('card-image').src = article.image;
            document.getElementById('card-image').onerror = function() { this.src = 'https://placehold.co/480x200/0a0c10/c9d1d9?text=Image+Not+Found'; };
            document.getElementById('card-title').textContent = article.title;
            document.getElementById('card-author').textContent = `By ${article.author}`;
            document.getElementById('card-summary').textContent = article.summary;
            document.getElementById('card-link').href = article.link;
            infoCard.classList.add('visible');
        }

        function hideInfoCard() {
            infoCard.classList.remove('visible');
        }

        // --- Event Listeners ---
        closeCardBtn.addEventListener('click', hideInfoCard);
        
        mapContainer.addEventListener('click', (e) => {
            if (e.target === mapContainer) {
                hideInfoCard();
            }
        });

        window.addEventListener('resize', () => {
            resizeCanvas();
            drawBackground();
        });

        // --- Initialize ---
        resizeCanvas();
        initializeMap();
        drawBackground();
        animate();

    </script>
</body>
</html>
